/*
* @Author: caoke
* @Date:   2015-05-21 11:34:01
* @Last Modified by:   caoke
* @Last Modified time: 2015-11-29 21:47:42
*/

"use strict";

var fs = require("fs");
var path = require("path");
var yargs = require("yargs");

try {

    // read abc.json
    var abc = {};
    if (fs.existsSync("abc.json")) {
        abc = JSON.parse(fs.readFileSync("abc.json", "utf-8"));
    }
    abc.options = abc.options || {};
    yargs.alias("buildTo", "dist").default(abc.options);
} catch (e) {
    console.log("Error parse 'abc.json'");
    process.exit(1);
}

// choose matched gulpfile
var type = null;
switch (abc.options.type) {
    case "h5":
    case "tingle":
    case "uxcore":
        type = "webpack";
        break;
    default:
        type = "seajs";
}

// find gulp tasks
module.exports = require(path.join(__dirname, 'tasks', type));
