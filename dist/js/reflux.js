define(function(t,e,n){!function(t){if("object"==typeof e&&"undefined"!=typeof n)n.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.Reflux=t()}}(function(){return function e(n,i,r){function o(c,a){if(!i[c]){if(!n[c]){var l="function"==typeof t&&t;if(!a&&l)return l(c,!0);if(s)return s(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var f=i[c]={exports:{}};n[c][0].call(f.exports,function(t){var e=n[c][1][t];return o(e?e:t)},f,f.exports,e,n,i,r)}return i[c].exports}for(var s="function"==typeof t&&t,c=0;c<r.length;c++)o(r[c]);return o}({1:[function(t,e,n){"use strict";function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}var o="function"!=typeof Object.create?"~":!1;r.prototype._events=void 0,r.prototype.listeners=function(t,e){var n=o?o+t:t,i=this._events&&this._events[n];if(e)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,c=new Array(s);s>r;r++)c[r]=i[r].fn;return c},r.prototype.emit=function(t,e,n,i,r,s){var c=o?o+t:t;if(!this._events||!this._events[c])return!1;var a,l,u=this._events[c],f=arguments.length;if("function"==typeof u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,i),!0;case 5:return u.fn.call(u.context,e,n,i,r),!0;case 6:return u.fn.call(u.context,e,n,i,r,s),!0}for(l=1,a=new Array(f-1);f>l;l++)a[l-1]=arguments[l];u.fn.apply(u.context,a)}else{var h,p=u.length;for(l=0;p>l;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),f){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,n);break;default:if(!a)for(h=1,a=new Array(f-1);f>h;h++)a[h-1]=arguments[h];u[l].fn.apply(u[l].context,a)}}return!0},r.prototype.on=function(t,e,n){var r=new i(e,n||this),s=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):this._events[s]=r,this},r.prototype.once=function(t,e,n){var r=new i(e,n||this,!0),s=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):this._events[s]=r,this},r.prototype.removeListener=function(t,e,n,i){var r=o?o+t:t;if(!this._events||!this._events[r])return this;var s=this._events[r],c=[];if(e)if(s.fn)(s.fn!==e||i&&!s.once||n&&s.context!==n)&&c.push(s);else for(var a=0,l=s.length;l>a;a++)(s[a].fn!==e||i&&!s[a].once||n&&s[a].context!==n)&&c.push(s[a]);return c.length?this._events[r]=1===c.length?c[0]:c:delete this._events[r],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[o?o+t:t]:this._events=o?{}:Object.create(null),this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=o,"undefined"!=typeof e&&(e.exports=r)},{}],2:[function(t,e,n){e.exports={}},{}],3:[function(t,e,n){n.createdStores=[],n.createdActions=[],n.reset=function(){for(;n.createdStores.length;)n.createdStores.pop();for(;n.createdActions.length;)n.createdActions.pop()}},{}],4:[function(t,e,n){var i=t("./utils"),r=t("./joins").instanceJoinCreator,o=function(t){for(var e,n=0,i={};n<(t.children||[]).length;++n)e=t.children[n],t[e]&&(i[e]=t[e]);return i},s=function(t){var e={};for(var n in t){var r=t[n],c=o(r),a=s(c);e[n]=r;for(var l in a){var u=a[l];e[n+i.capitalize(l)]=u}}return e};e.exports={hasListener:function(t){for(var e,n,i,r=0;r<(this.subscriptions||[]).length;++r)for(i=[].concat(this.subscriptions[r].listenable),e=0;e<i.length;e++)if(n=i[e],n===t||n.hasListener&&n.hasListener(t))return!0;return!1},listenToMany:function(t){var e=s(t);for(var n in e){var r=i.callbackName(n),o=this[r]?r:this[n]?n:void 0;o&&this.listenTo(e[n],o,this[r+"Default"]||this[o+"Default"]||o)}},validateListening:function(t){return t===this?"Listener is not able to listen to itself":i.isFunction(t.listen)?t.hasListener&&t.hasListener(this)?"Listener cannot listen to this listenable because of circular loop":void 0:t+" is missing a listen method"},listenTo:function(t,e,n){var r,o,s,c=this.subscriptions=this.subscriptions||[];return i.throwIf(this.validateListening(t)),this.fetchInitialState(t,n),r=t.listen(this[e]||e,this),o=function(){var t=c.indexOf(s);i.throwIf(-1===t,"Tried to remove listen already gone from subscriptions list!"),c.splice(t,1),r()},s={stop:o,listenable:t},c.push(s),s},stopListeningTo:function(t){for(var e,n=0,r=this.subscriptions||[];n<r.length;n++)if(e=r[n],e.listenable===t)return e.stop(),i.throwIf(-1!==r.indexOf(e),"Failed to remove listen from subscriptions list!"),!0;return!1},stopListeningToAll:function(){for(var t,e=this.subscriptions||[];t=e.length;)e[0].stop(),i.throwIf(e.length!==t-1,"Failed to remove listen from subscriptions list!")},fetchInitialState:function(t,e){e=e&&this[e]||e;var n=this;if(i.isFunction(e)&&i.isFunction(t.getInitialState)){var r=t.getInitialState();r&&i.isFunction(r.then)?r.then(function(){e.apply(n,arguments)}):e.call(this,r)}},joinTrailing:r("last"),joinLeading:r("first"),joinConcat:r("all"),joinStrict:r("strict")}},{"./joins":14,"./utils":18}],5:[function(t,e,n){var i=t("./utils"),r=t("./ListenerMethods");e.exports=i.extend({componentWillUnmount:r.stopListeningToAll},r)},{"./ListenerMethods":4,"./utils":18}],6:[function(t,e,n){var i=t("./utils");e.exports={preEmit:function(){},shouldEmit:function(){return!0},listen:function(t,e){e=e||this;var n=function(n){r||t.apply(e,n)},i=this,r=!1;return this.emitter.addListener(this.eventLabel,n),function(){r=!0,i.emitter.removeListener(i.eventLabel,n)}},promise:function(t){var e=this,n=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0;if(!n)throw new Error('Publisher must have "completed" and "failed" child publishers');t.then(function(t){return e.completed(t)},function(t){return e.failed(t)})},listenAndPromise:function(t,e){var n=this;e=e||this,this.willCallPromise=(this.willCallPromise||0)+1;var i=this.listen(function(){if(!t)throw new Error("Expected a function returning a promise but got "+t);var i=arguments,r=t.apply(e,i);return n.promise.call(n,r)},e);return function(){n.willCallPromise--,i.call(n)}},trigger:function(){var t=arguments,e=this.preEmit.apply(this,t);t=void 0===e?t:i.isArguments(e)?e:[].concat(e),this.shouldEmit.apply(this,t)&&this.emitter.emit(this.eventLabel,t)},triggerAsync:function(){var t=arguments,e=this;i.nextTick(function(){e.trigger.apply(e,t)})},triggerPromise:function(){var t=this,e=arguments,n=this.children.indexOf("completed")>=0&&this.children.indexOf("failed")>=0,r=i.createPromise(function(r,o){if(t.willCallPromise)return void i.nextTick(function(){var n=t.promise;t.promise=function(e){return e.then(r,o),t.promise=n,t.promise.apply(t,arguments)},t.trigger.apply(t,e)});if(n)var s=t.completed.listen(function(t){s(),c(),r(t)}),c=t.failed.listen(function(t){s(),c(),o(t)});t.triggerAsync.apply(t,e),n||r()});return r}}},{"./utils":18}],7:[function(t,e,n){e.exports={}},{}],8:[function(t,e,n){e.exports=function(t,e){for(var n in e)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var i=Object.getOwnPropertyDescriptor(e,n);if(!i.value||"function"!=typeof i.value||!e.hasOwnProperty(n))continue;t[n]=e[n].bind(t)}else{var r=e[n];if("function"!=typeof r||!e.hasOwnProperty(n))continue;t[n]=r.bind(t)}return t}},{}],9:[function(t,e,n){var i=t("./ListenerMethods"),r=t("./ListenerMixin"),o=t("./utils");e.exports=function(t,e){return{getInitialState:function(){return o.isFunction(t.getInitialState)?void 0===e?t.getInitialState():o.object([e],[t.getInitialState()]):{}},componentDidMount:function(){o.extend(this,i);var n=this,r=void 0===e?this.setState:function(t){("undefined"==typeof n.isMounted||n.isMounted()===!0)&&n.setState(o.object([e],[t]))};this.listenTo(t,r)},componentWillUnmount:r.componentWillUnmount}}},{"./ListenerMethods":4,"./ListenerMixin":5,"./utils":18}],10:[function(t,e,n){var i=t("./ListenerMethods"),r=t("./ListenerMixin"),o=t("./utils");e.exports=function(t,e,n){return n=o.isFunction(e)?e:n,{getInitialState:function(){if(o.isFunction(t.getInitialState)){if(o.isFunction(e))return n.call(this,t.getInitialState());var i=n.call(this,t.getInitialState());return"undefined"!=typeof i?o.object([e],[i]):{}}return{}},componentDidMount:function(){o.extend(this,i);var r=this,s=function(t){if(o.isFunction(e))r.setState(n.call(r,t));else{var i=n.call(r,t);r.setState(o.object([e],[i]))}};this.listenTo(t,s)},componentWillUnmount:r.componentWillUnmount}}},{"./ListenerMethods":4,"./ListenerMixin":5,"./utils":18}],11:[function(t,e,n){var i=t("./utils"),r=t("./ActionMethods"),o=t("./PublisherMethods"),s=t("./Keep"),c={preEmit:1,shouldEmit:1},a=function(t){t=t||{},i.isObject(t)||(t={actionName:t});for(var e in r)if(!c[e]&&o[e])throw new Error("Cannot override API method "+e+" in Reflux.ActionMethods. Use another method name or override it on Reflux.PublisherMethods instead.");for(var n in t)if(!c[n]&&o[n])throw new Error("Cannot override API method "+n+" in action creation. Use another method name or override it on Reflux.PublisherMethods instead.");t.children=t.children||[],t.asyncResult&&(t.children=t.children.concat(["completed","failed"]));for(var l=0,u={};l<t.children.length;l++){var f=t.children[l];u[f]=a(f)}var h=i.extend({eventLabel:"action",emitter:new i.EventEmitter,_isAction:!0},o,r,t),p=function(){var t=p.sync?"trigger":i.environment.hasPromises?"triggerPromise":"triggerAsync";return p[t].apply(p,arguments)};return i.extend(p,u,h),s.createdActions.push(p),p};e.exports=a},{"./ActionMethods":2,"./Keep":3,"./PublisherMethods":6,"./utils":18}],12:[function(t,e,n){var i=t("./utils"),r=t("./Keep"),o=t("./mixer"),s={preEmit:1,shouldEmit:1},c=t("./bindMethods");e.exports=function(e){function n(){var t,n=0;if(this.subscriptions=[],this.emitter=new i.EventEmitter,this.eventLabel="change",c(this,e),this.init&&i.isFunction(this.init)&&this.init(),this.listenables)for(t=[].concat(this.listenables);n<t.length;n++)this.listenToMany(t[n])}var a=t("./StoreMethods"),l=t("./PublisherMethods"),u=t("./ListenerMethods");e=e||{};for(var f in a)if(!s[f]&&(l[f]||u[f]))throw new Error("Cannot override API method "+f+" in Reflux.StoreMethods. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");for(var h in e)if(!s[h]&&(l[h]||u[h]))throw new Error("Cannot override API method "+h+" in store creation. Use another method name or override it on Reflux.PublisherMethods / Reflux.ListenerMethods instead.");e=o(e),i.extend(n.prototype,u,l,a,e);var p=new n;return r.createdStores.push(p),p}},{"./Keep":3,"./ListenerMethods":4,"./PublisherMethods":6,"./StoreMethods":7,"./bindMethods":8,"./mixer":17,"./utils":18}],13:[function(t,e,n){n.ActionMethods=t("./ActionMethods"),n.ListenerMethods=t("./ListenerMethods"),n.PublisherMethods=t("./PublisherMethods"),n.StoreMethods=t("./StoreMethods"),n.createAction=t("./createAction"),n.createStore=t("./createStore"),n.connect=t("./connect"),n.connectFilter=t("./connectFilter"),n.ListenerMixin=t("./ListenerMixin"),n.listenTo=t("./listenTo"),n.listenToMany=t("./listenToMany");var i=t("./joins").staticJoinCreator;n.joinTrailing=n.all=i("last"),n.joinLeading=i("first"),n.joinStrict=i("strict"),n.joinConcat=i("all");var r=n.utils=t("./utils");n.EventEmitter=r.EventEmitter,n.Promise=r.Promise,n.createActions=function(t){var e={};for(var i in t)if(t.hasOwnProperty(i)){var o=t[i],s=r.isObject(o)?i:o;e[s]=n.createAction(o)}return e},n.setEventEmitter=function(t){n.EventEmitter=r.EventEmitter=t},n.setPromise=function(t){n.Promise=r.Promise=t},n.setPromiseFactory=function(t){r.createPromise=t},n.nextTick=function(t){r.nextTick=t},n.__keep=t("./Keep"),Function.prototype.bind||console.error("Function.prototype.bind not available. ES5 shim required. https://github.com/spoike/refluxjs#es5")},{"./ActionMethods":2,"./Keep":3,"./ListenerMethods":4,"./ListenerMixin":5,"./PublisherMethods":6,"./StoreMethods":7,"./connect":9,"./connectFilter":10,"./createAction":11,"./createStore":12,"./joins":14,"./listenTo":15,"./listenToMany":16,"./utils":18}],14:[function(t,e,n){function i(t,e,n){return function(){var i,r=n.subscriptions,o=r?r.indexOf(t):-1;for(a.throwIf(-1===o,"Tried to remove join already gone from subscriptions list!"),i=0;i<e.length;i++)e[i]();r.splice(o,1)}}function r(t){t.listenablesEmitted=new Array(t.numberOfListenables),t.args=new Array(t.numberOfListenables)}function o(t,e){return function(){var n=c.call(arguments);if(e.listenablesEmitted[t])switch(e.strategy){case"strict":throw new Error("Strict join failed because listener triggered twice.");case"last":e.args[t]=n;break;case"all":e.args[t].push(n)}else e.listenablesEmitted[t]=!0,e.args[t]="all"===e.strategy?[n]:n;s(e)}}function s(t){for(var e=0;e<t.numberOfListenables;e++)if(!t.listenablesEmitted[e])return;t.callback.apply(t.listener,t.args),r(t)}var c=Array.prototype.slice,a=t("./utils"),l=t("./createStore"),u={strict:"joinStrict",first:"joinLeading",last:"joinTrailing",all:"joinConcat"};n.staticJoinCreator=function(t){return function(){var e=c.call(arguments);return l({init:function(){this[u[t]].apply(this,e.concat("triggerAsync"))}})}},n.instanceJoinCreator=function(t){return function(){a.throwIf(arguments.length<2,"Cannot create a join with less than 2 listenables!");var e,n,s=c.call(arguments),l=s.pop(),u=s.length,f={numberOfListenables:u,callback:this[l]||l,listener:this,strategy:t},h=[];for(e=0;u>e;e++)a.throwIf(this.validateListening(s[e]));for(e=0;u>e;e++)h.push(s[e].listen(o(e,f),this));return r(f),n={listenable:s},n.stop=i(n,h,this),this.subscriptions=(this.subscriptions||[]).concat(n),n}}},{"./createStore":12,"./utils":18}],15:[function(t,e,n){var i=t("./ListenerMethods");e.exports=function(t,e,n){return{componentDidMount:function(){for(var r in i)if(this[r]!==i[r]){if(this[r])throw"Can't have other property '"+r+"' when using Reflux.listenTo!";this[r]=i[r]}this.listenTo(t,e,n)},componentWillUnmount:i.stopListeningToAll}}},{"./ListenerMethods":4}],16:[function(t,e,n){var i=t("./ListenerMethods");e.exports=function(t){return{componentDidMount:function(){for(var e in i)if(this[e]!==i[e]){if(this[e])throw"Can't have other property '"+e+"' when using Reflux.listenToMany!";this[e]=i[e]}this.listenToMany(t)},componentWillUnmount:i.stopListeningToAll}}},{"./ListenerMethods":4}],17:[function(t,e,n){var i=t("./utils");e.exports=function(t){var e={init:[],preEmit:[],shouldEmit:[]},n=function r(t){var n={};return t.mixins&&t.mixins.forEach(function(t){i.extend(n,r(t))}),i.extend(n,t),Object.keys(e).forEach(function(n){t.hasOwnProperty(n)&&e[n].push(t[n])}),n}(t);return e.init.length>1&&(n.init=function(){var t=arguments;e.init.forEach(function(e){e.apply(this,t)},this)}),e.preEmit.length>1&&(n.preEmit=function(){return e.preEmit.reduce(function(t,e){var n=e.apply(this,t);return void 0===n?t:[n]}.bind(this),arguments)}),e.shouldEmit.length>1&&(n.shouldEmit=function(){var t=arguments;return!e.shouldEmit.some(function(e){return!e.apply(this,t)},this)}),Object.keys(e).forEach(function(t){1===e[t].length&&(n[t]=e[t][0])}),n}},{"./utils":18}],18:[function(t,e,n){n.environment={};var i=n.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t};n.extend=function(t){if(!i(t))return t;for(var e,n,r=1,o=arguments.length;o>r;r++){e=arguments[r];for(n in e)if(Object.getOwnPropertyDescriptor&&Object.defineProperty){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,s)}else t[n]=e[n]}return t},n.isFunction=function(t){return"function"==typeof t},n.EventEmitter=t("eventemitter3"),n.nextTick=function(t){setTimeout(t,0)},n.capitalize=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},n.callbackName=function(t){return"on"+n.capitalize(t)},n.object=function(t,e){for(var n={},i=0;i<t.length;i++)n[t[i]]=e[i];return n};try{n.Promise=Promise,n.createPromise=function(t){return new n.Promise(t)}}catch(r){n.Promise=null,n.createPromise=function(){}}n.environment.hasPromises=!!n.Promise,n.isArguments=function(t){return"object"==typeof t&&"callee"in t&&"number"==typeof t.length},n.throwIf=function(t,e){if(t)throw Error(e||t)}},{eventemitter3:1}]},{},[13])(13)})});